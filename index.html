<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📞 학교 비상연락망 자동 생성기</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📞</text></svg>">
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>📞 학교 비상연락망 자동 생성기</h1>
            <p class="subtitle">Google Forms로 수집한 데이터를 멋진 조직도로 자동 변환!</p>
        </header>

        <!-- 사용 안내 섹션 -->
        <div class="guide-section">
            <h2>🔥 사용 방법 (3단계로 완료!)</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Google Forms 만들기</h3>
                        <p>아래 필드들로 구글 폼을 만드세요</p>
                        <ul>
                            <li>부서명 (예: 교무부, 생활지도부, 학년부)</li>
                            <li>직책 (교장/교감/부장/부원/담임)</li>
                            <li>이름</li>
                            <li>전화번호 (010-1234-5678 형식)</li>
                            <li>학년반 (담임만, 예: 1-1, 2-3)</li>
                        </ul>
                        <button onclick="showSampleForm()" class="sample-btn">📝 샘플 폼 보기</button>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>데이터 입력 또는 업로드</h3>
                        <p>Google Forms로 데이터 수집 후 여기에 입력하거나 CSV 파일 업로드</p>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>조직도 생성 및 인쇄</h3>
                        <p>자동으로 멋진 조직도가 생성되고 A4로 인쇄 가능!</p>
                    </div>
                </div>
            </div>
            
            <!-- 특별 안내 추가 -->
            <div class="special-tip">
                <strong>🎯 고급 기능 팁!</strong>
                소수 부서(2명 이하)끼리 드래그해서 합치거나 더블클릭으로 분리할 수 있습니다. 
                이렇게 하면 비슷한 부서들을 하나로 묶어서 더 깔끔한 조직도를 만들 수 있어요!
            </div>
        </div>

        <!-- 데이터 입력 방법 선택 -->
        <div class="input-method-section">
            <h2>📊 데이터 입력 방법 선택</h2>
            <div class="input-methods">
                <button onclick="showManualInput()" class="method-btn active" id="manualBtn">
                    ✏️ 직접 입력하기
                </button>
                <button onclick="showFileUpload()" class="method-btn" id="fileBtn">
                    📁 CSV 파일 업로드
                </button>
                <button onclick="showSampleData()" class="method-btn" id="sampleBtn">
                    🎯 샘플 데이터로 체험
                </button>
            </div>
        </div>

        <!-- 직접 입력 섹션 -->
        <div class="manual-input-section" id="manualInputSection">
            <h3>✏️ 직접 입력하기</h3>
            
            <!-- 학교명 입력 추가 -->
            <div class="school-info-section">
                <h4>🏫 학교 정보 설정</h4>
                <div class="school-inputs">
                    <input type="text" id="schoolName" placeholder="학교명을 입력하세요 (예: ○○중학교, ○○고등학교)" style="width: 48%; margin-right: 2%;">
                    <input type="text" id="schoolPhone" placeholder="학교 대표전화 (예: 02-1234-5678)" style="width: 48%;">
                </div>
            </div>
            
            <div class="form-container">
                <div class="input-form">
                    <select id="department">
                        <option value="">부서명 선택</option>
                        <option value="행정실">행정실</option>
                        <option value="교무부">교무부</option>
                        <option value="연구부">연구부</option>
                        <option value="학생부">학생부</option>
                        <option value="1학년부">1학년부</option>
                        <option value="2학년부">2학년부</option>
                        <option value="3학년부">3학년부</option>
                        <option value="기타">기타 (직접입력)</option>
                    </select>
                    <input type="text" id="customDepartment" placeholder="기타 부서명 직접 입력" style="display:none;">
                    <select id="position">
                        <option value="">직책 선택</option>
                        <option value="교장">교장</option>
                        <option value="교감">교감</option>
                        <option value="부장">부장</option>
                        <option value="부원">부원</option>
                        <option value="담임">담임</option>
                    </select>
                    <input type="text" id="name" placeholder="이름">
                    <input type="text" id="phone" placeholder="전화번호 (010-1234-5678)">
                    <input type="text" id="gradeClass" placeholder="학년반 (담임만, 예: 1-1)">
                    <button onclick="addPerson()" class="add-btn">➕ 추가</button>
                </div>
                
                <div class="current-data">
                    <h4>📋 현재 입력된 데이터</h4>
                    <div id="currentDataList"></div>
                    <button onclick="clearAllData()" class="clear-btn">🗑️ 전체 삭제</button>
                </div>
            </div>
        </div>

        <!-- 파일 업로드 섹션 -->
        <div class="file-upload-section" id="fileUploadSection" style="display:none;">
            <h3>📁 CSV 파일 업로드</h3>
            <div class="upload-area">
                <input type="file" id="csvFile" accept=".csv" onchange="handleFileUpload(event)">
                <p>CSV 파일을 선택하거나 여기에 드래그하세요</p>
                <small>형식: 부서명, 직책, 이름, 전화번호, 학년반</small>
            </div>
        </div>

        <!-- 샘플 데이터 섹션 -->
        <div class="sample-data-section" id="sampleDataSection" style="display:none;">
            <h3>🎯 샘플 데이터로 체험해보기</h3>
            <p>실제 학교 데이터 형식으로 미리 체험해보세요!</p>
            <button onclick="loadSampleData()" class="sample-load-btn">📊 샘플 데이터 불러오기</button>
        </div>

        <!-- 조직도 생성 버튼 -->
        <div class="generate-section">
            <button onclick="generateChart()" class="generate-btn" id="generateBtn" disabled>
                🎨 조직도 생성하기
            </button>
        </div>

        <!-- 미리보기 섹션 -->
        <div class="preview-section" id="previewSection" style="display:none;">
            <div class="preview-header">
                <h2>👀 미리보기</h2>
                <div class="preview-actions">
                    <button onclick="editMode()" class="edit-btn">✏️ 수정</button>
                    <button onclick="downloadPDF()" class="download-btn">📥 PDF 다운로드</button>
                    <button onclick="printChart()" class="print-btn">🖨️ 인쇄하기</button>
                </div>
            </div>
            <div class="chart-container">
                <div id="organizationChart"></div>
            </div>
        </div>

        <!-- 도움말 섹션 -->
        <div class="help-section">
            <h2>❓ 자주 묻는 질문</h2>
            <div class="faq">
                <details>
                    <summary>Google Forms는 어떻게 만드나요?</summary>
                    <p>forms.google.com에서 새 양식을 만들고, 위에 안내된 5개 필드를 추가하세요. 응답을 스프레드시트에 연결한 후 CSV로 다운로드하면 됩니다.</p>
                </details>
                <details>
                    <summary>담임 선생님 학년반은 어떻게 입력하나요?</summary>
                    <p>"1-1", "2-3", "3-2" 형식으로 입력하세요. 숫자-숫자 형태로 입력하면 자동으로 정렬됩니다.</p>
                </details>
                <details>
                    <summary>소수 부서끼리 합치거나 분리하려면?</summary>
                    <p><strong>합치기:</strong> 2명 이하 부서를 다른 소수 부서로 드래그하면 자동으로 합쳐집니다. <strong>분리:</strong> 합쳐진 부서를 더블클릭하면 다시 분리됩니다. 예를 들어 '보건실'과 '영양실'을 합쳐서 '보건실/영양실'로 표시할 수 있어요!</p>
                </details>
                <details>
                    <summary>인쇄 시 한 페이지에 안 들어가요</summary>
                    <p>브라우저의 인쇄 설정에서 "더 많은 설정 → 크기 조정"을 80-90%로 조정해보세요.</p>
                </details>
                <details>
                    <summary>데이터를 수정하고 싶어요</summary>
                    <p>미리보기 화면에서 "수정" 버튼을 클릭하면 다시 입력 화면으로 돌아갑니다.</p>
                </details>
            </div>
        </div>

        <!-- 푸터 -->
        <footer class="app-footer">
            <p>Made with ❤️ for 🏫 Schools | 버전 1.0</p>
            <p><small>문의: emergency-contact-generator@school.com</small></p>
        </footer>
    </div>

    <!-- 샘플 폼 모달 -->
    <div id="sampleFormModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close" onclick="closeSampleForm()">&times;</span>
            <h3>📝 Google Forms 샘플 구성</h3>
            <div class="sample-form-fields">
                <div class="field-example">
                    <strong>질문 1: 부서명</strong>
                    <p>유형: 단답형 | 예시: 교무부, 생활지도부, 학년부</p>
                </div>
                <div class="field-example">
                    <strong>질문 2: 직책</strong>
                    <p>유형: 객관식 | 선택지: 교장, 교감, 부장, 부원, 담임</p>
                </div>
                <div class="field-example">
                    <strong>질문 3: 이름</strong>
                    <p>유형: 단답형 | 예시: 홍길동</p>
                </div>
                <div class="field-example">
                    <strong>질문 4: 전화번호</strong>
                    <p>유형: 단답형 | 예시: 010-1234-5678</p>
                </div>
                <div class="field-example">
                    <strong>질문 5: 학년반 (선택사항)</strong>
                    <p>유형: 단답형 | 예시: 1-1, 2-3 (담임만 작성)</p>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>